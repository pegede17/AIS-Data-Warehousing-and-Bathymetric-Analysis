WITH grid AS (
SELECT (ST_SquareGrid(10000, ST_Transform(geom,3034))).*
FROM danish_waters
WHERE 
),
denmark as (
	SELECT ST_Transform(ST_Simplify(geom,0.05),3034) geom from danish_waters
)
  SELECT ST_Transform(g.geom,4326)
  FROM grid g, denmark d
  WHERE ST_Intersects(g.geom, d.geom)
  
  
CREATE TABLE boundaries_50m(
	boundary_id BIGSERIAL PRIMARY KEY,
	boundary GEOMETRY(POLYGON)
);

CREATE TABLE boundaries_1000m(
	boundary_id BIGSERIAL PRIMARY KEY,
	boundary GEOMETRY(POLYGON)
);

CREATE TABLE dim_cell (
	cell_id BIGSERIAL PRIMARY KEY,
	boundary_50m_id BIGINT,
	boundary_1000m_id BIGINT,
	FOREIGN KEY (boundary_50m_id)
		REFERENCES boundaries_50m (boundary_id),
	FOREIGN KEY (boundary_1000m_id)
		REFERENCES boundaries_1000m (boundary_id)
);

WITH grid AS (
SELECT (ST_SquareGrid(1000, ST_Transform(geom,3034))).*
FROM danish_waters
) --,
-- denmark as (
-- 	SELECT ST_Transform(ST_Simplify(geom,0.05),3034) geom from danish_waters
-- )  
INSERT INTO boundaries_1000m (boundary)
SELECT ST_Transform(g.geom,4326)
  FROM grid g --, denmark d
--   WHERE ST_Intersects(g.geom, d.geom)

WITH grid AS (
SELECT (ST_SquareGrid(50, ST_Transform(geom,3034))).*
FROM danish_waters
) --,
-- denmark as (
-- 	SELECT ST_Transform(ST_Simplify(geom,0.05),3034) geom from danish_waters
-- )
INSERT INTO boundaries_50m (boundary)
SELECT ST_Transform(g.geom,4326)
  FROM grid g --, denmark d
--   WHERE ST_Intersects(g.geom, d.geom)

INSERT INTO dim_cell (boundary_50m_id, boundary_1000m_id)
SELECT b50.boundary_id, b1000.boundary_id
FROM boundaries_50m b50, boundaries_1000m b1000,
WHERE ST_Contains(b1000.boundary, b50.boundary)