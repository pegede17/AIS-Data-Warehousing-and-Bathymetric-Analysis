SELECT ship_type, mobile_type, device_type, ship_id, mmsi, imo, name, width, length, callsign, size_a, size_b, size_c, size_d from dim_ship s 
join dim_ship_type st on s.ship_type_id = st.ship_type_id 
join dim_type_of_mobile tm on tm.type_of_mobile_id = s.type_of_mobile_id 
join dim_type_of_position_fixing_device tp on s.type_of_position_fixing_device_id = tp.type_of_position_fixing_device_id

where mmsi=331569000

SELECT count(fact_id) from fact_ais where ship_id = 6680


6680
6716

SELECT s1.mmsi, t1.mobile_type, t2.mobile_type 
from dim_ship s1 
join dim_ship s2 on s1.mmsi = s2.mmsi 
join dim_type_of_mobile t1 on t1.type_of_mobile_id = s1.type_of_mobile_id 
join dim_type_of_mobile t2 on t2.type_of_mobile_id = s2.type_of_mobile_id  

where not s1.type_of_mobile_id = s2.type_of_mobile_id

SELECT count(*) from dim_ship
